<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevOS Terminal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1e1e1e;
            color: #ffffff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        #terminal {
            flex: 1;
            padding: 10px;
            border: 1px solid #444;
            margin-bottom: 10px;
            overflow: hidden;
        }
        .command {
            color: #00ff00;
        }
        .output {
            color: #ffffff;
        }
        #commandInput {
            width: 100%;
            padding: 10px;
            border: none;
            outline: none;
            background-color: #2e2e2e;
            color: #ffffff;
        }
        #forcePanicModal, #panicProcessModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #333;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .modal-buttons button {
            margin: 5px;
            padding: 10px;
            background-color: #444;
            color: #fff;
            border: none;
            cursor: pointer;
        }
        .modal-buttons button:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div id="output"></div>
    </div>
    <input type="text" id="commandInput" placeholder="Enter command...">

    <div id="forcePanicModal">
        <p>Are you sure you want to force a kernel panic?</p>
        <div class="modal-buttons">
            <button id="forcePanicYes">Yes</button>
            <button id="forcePanicNo">No</button>
        </div>
    </div>

    <div id="panicProcessModal">
        <p>Kernel panic in progress. Please wait...</p>
    </div>
<script src="../../ui/cursor/MOUSE.elf"></script>
    <script>
        const terminalOutput = document.getElementById('output');
        const commandInput = document.getElementById('commandInput');
        const forcePanicModal = document.getElementById('forcePanicModal');
        const panicProcessModal = document.getElementById('panicProcessModal');
        const forcePanicYes = document.getElementById('forcePanicYes');
        const forcePanicNo = document.getElementById('forcePanicNo');
        let isAwaitingPassword = false;

        // Predefined commands
        const commands = {
            '/end-temp': () => {
                window.location.href = '../../end/rest.html';
                return 'Exiting terminal...';
            },
            '/end-perm': () => {
                window.location.href = '../../end/shut.html';
                return 'Exiting terminal...';
            },
            '/about-system': () => {
                return `About TestOS
Operating System: TestOS
Version: 4.0.0
Kernel: NexShell
Build: 2025.01.25
License: Open Source downloadable
Developer: XPDevs`;
            },
            '/help': () => {
                return `Available Commands:
- /end-temp - Exit to temporary shutdown
- /end-perm - Exit to permanent shutdown
- /reset-all - Reset the system after password verification
- /about-system - Show system information
- /clear - Clear the terminal screen
- /date - Display the current date and time
- /echo [text] - Echo back the provided text
- /force-panic - Force a kernel panic`;
            },
            '/clear': () => {
                terminalOutput.innerHTML = '';
                return '';
            },
            '/date': () => {
                return new Date().toString();
            },
            '/echo': (text) => {
                return text ? text : 'Error: No text provided';
            },
            '/reset-all': () => {
                isAwaitingPassword = true;
                appendToTerminal('/reset-all', 'Enter root password:');
                return '';
            },
            '/force-panic': () => {
                forcePanicModal.style.display = 'block'; // Show the modal
                return 'Are you sure you want to force a kernel panic?';
            }
        };

        commandInput.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                const input = commandInput.value.trim();
                commandInput.value = '';
                if (isAwaitingPassword) {
                    validatePassword(input);
                } else {
                    processCommand(input);
                }
            }
        });

        function validatePassword(input) {
            if (input === "root") {
                localStorage.clear();
                appendToTerminal('', 'Local storage cleared. Please restart to apply changes.');
            } else {
                appendToTerminal('', 'Incorrect password. Access denied.');
            }
            isAwaitingPassword = false;
        }

        function processCommand(input) {
            let output;
            const parts = input.split(' ');
            const command = parts[0];
            const argument = parts.slice(1).join(' ');

            if (commands[command]) {
                output = commands[command](argument);
            } else {
                output = `Command not found: ${input}`;
            }
            appendToTerminal(input, output);
        }

        function appendToTerminal(input, output) {
            if (input) terminalOutput.innerHTML += `<div class="command">> ${input}</div>`;
            if (output) terminalOutput.innerHTML += `<div class="output">${output}</div>`;
        }

        forcePanicYes.addEventListener('click', () => {
            forcePanicModal.style.display = 'none'; // Hide first modal
            panicProcessModal.style.display = 'block'; // Show panic process modal
            // Simulate kernel panic process
            setTimeout(() => {
                panicProcessModal.style.display = 'none'; // Hide panic process modal
                appendToTerminal('', 'The kernel panic has been successfully triggered. The system will need a full restart.');
                
                // Redirect to another HTML file
                window.location.href = '../../error/error.html'; // Change this to the correct file path
            }, 5000); // Panic process lasts for 5 seconds
        });

        forcePanicNo.addEventListener('click', () => {
            forcePanicModal.style.display = 'none'; // Close the modal
            appendToTerminal('', 'Returning to terminal...');
        });
    </script>
</body>
</html>
