<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Screen Custom Terminal</title>
    <style>
        /* Full screen styling */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            height: 100%;
            background-color: black;
            color: white;
            font-family: Consolas, monospace;
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            font-size: 20px;
            overflow: hidden; /* Remove overall scrollbars */
            cursor: none; /* Hide cursor globally */
        }

        .cursor {
            position: absolute;
            width: 32px;
            height: 32px;
            background-image: url('../../ui/cursor/terminal.ico');
            background-size: contain;
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 9999;
        }

        #terminal {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            padding: 10px;
            white-space: pre-wrap;
            overflow: hidden;
            cursor: none;
        }

        .output {
            color: #FFFFFF;
            margin: 2px 0;
            cursor: none;
        }

        .command {
            color: #00FF00;
            cursor: none;
        }

        input {
            color: #00FF00;
            background-color: black;
            border: none;
            outline: none;
            width: 100%;
            font-size: 18px;
            padding: 5px;
            cursor: none;
        }

        #inputArea {
            display: flex;
            align-items: center;
            width: 100%;
            cursor: none;
        }

        span {
            color: white;
            cursor: none;
        }

        #terminal {
            display: block;
            overflow-y: auto;
            cursor: none;
        }
    </style>
</head>
<body>
<div class="cursor" id="cursor"></div>
    <div id="terminal">
        <div class="output" id="output"></div>
        <div id="inputArea">
            <span>> </span><input type="text" id="commandInput" autofocus />
        </div>
    </div>

    <script>
        const terminalOutput = document.getElementById('output');
        const commandInput = document.getElementById('commandInput');
        let isAwaitingPassword = false; // To track if we're waiting for a password input

        // Predefined commands
        const commands = {
            '/end-temp': () => {
                window.location.href = '../../end/rest.html'; // Temporary shutdown
                return 'Exiting terminal...';
            },
            '/end-perm': () => {
                window.location.href = '../../end/shut.html'; // Permanent shutdown
                return 'Exiting terminal...';
            },
            '/about-system': () => {
                return `
About DevOS
Operating System: DevOS
Version: 4.0.0
Kernel: NexShell
Build: 2024.12.15
License: Open Source downloadable
Developer: XPDevs
                `;
            },
            '/help': () => {
                return `
Available Commands:
- /end-temp - Exit to temporary shutdown
- /end-perm - Exit to permanent shutdown
- /reset-all - Reset the system after password verification
- /about-system - Show system information
- /clear - Clear the terminal screen
- /date - Display the current date and time
- /echo [text] - Echo back the provided text
                `;
            },
            '/clear': () => {
                terminalOutput.innerHTML = ''; // Clears the terminal
                return '';
            },
            '/date': () => {
                return new Date().toString();
            },
            '/echo': (text) => {
                return text ? text : 'Error: No text provided';
            },
            '/reset-all': () => {
                isAwaitingPassword = true;
                appendToTerminal('/reset-all', 'Enter root password:');
                return ''; // Await user input
            }
        };

        // Process the input when user presses enter
        commandInput.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                const input = commandInput.value.trim();
                commandInput.value = '';
                if (isAwaitingPassword) {
                    validatePassword(input); // Validate the password
                } else {
                    processCommand(input);
                }
            }
        });

        // Validate password for reset-all
        function validatePassword(input) {
            if (input === "root") {
                localStorage.clear(); // Clear local storage
                appendToTerminal('', 'Local storage cleared. Please restart to apply changes.');
            } else {
                appendToTerminal('', 'Incorrect password. Access denied.');
            }
            isAwaitingPassword = false; // Reset the flag
        }

        // Process commands and show the output
        function processCommand(input) {
            let output;
            const parts = input.split(' ');  // Split input into command and arguments
            const command = parts[0];
            const argument = parts.slice(1).join(' '); // Combine all arguments after the command

            if (commands[command]) {
                output = commands[command](argument);
            } else {
                output = `Command not found: ${input}`; // Add message for unrecognized commands
            }
            appendToTerminal(input, output);
        }

        // Append the user's input and the output to the terminal
        function appendToTerminal(input, output) {
            if (input) terminalOutput.innerHTML += `<div class="command">> ${input}</div>`;
            if (output) terminalOutput.innerHTML += `<div class="output">${output}</div>`;
        }

        const cursor = document.getElementById('cursor');

        // Track mouse movement and set the custom cursor position
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = `${e.pageX}px`;
            cursor.style.top = `${e.pageY}px`;
        });
    </script>

</body>
</html>
